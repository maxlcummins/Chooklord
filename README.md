# Avian Plasmid Read-Mapping Plot

NOTE: This script has been modified from a pre-existing script available at <https://github.com/cerebis/antarctic_ha>.

It contains scripts supporting an investigation into Avian Pathogenic Escherichia coli.

Paper available at:

The python script 'analysis.py' was used to produce the described heatmap:

# index the reference
```
bwa index myref.fasta
```

# bwa_run.sh will contain a line for each sample you want to process, as below.
```
bwa mem -t16 -MY $REF $R1 $R2 | ~/miniconda3/bin/samtools view -ubS -F 0x904 - | ~/miniconda3/bin/samtools sort -@8 -T $REF - -o ${R1}.bam           
```
# move all generated files to a new folder, move to that folder and execute the following
```
for f in refname_*; do echo mv "$f" "$f.bam"; done
```
# check that the commands generated by above look like they will correctly change names, then continue
```
for f in refname_ do mv "$f" "$f.bam"; done
```
# execute samtools depth on these files
```
for fn in `ls ./*.bam`; do samtools depth ${fn} > ${fn}.test; done
```
# rename files to end in _coverage.txt
```
for f in *.bam.test; do mv "$f" "${f%.bam.test}_coverage.txt"; done
```
execute python script (can be git cloned from https://github.com/cerebis/readdepth_plot.git , use the readme from there to install it correctly).
```
python ~/readdepth_plot/readdepth_plot.py -b <binsize> -t <ticksize> ~/mycov_pCERC4/ ~/testplot_pCERC4_2.pdf




bwa                       0.7.17               pl5.22.0_0    bioconda
samtools                  0.1.18                        0    bioconda
pandas                    0.20.3           py27h820b67f_2 
numpy                     1.13.3           py27hbcc08e0_0  
scipy                     0.19.1           py27h1edc525_3
matplotlib                2.1.0            py27h09aba24_0
